"use strict";(self.webpackChunkthreejs_learning=self.webpackChunkthreejs_learning||[]).push([[113],{6113:(G,d,f)=>{f.r(d),f.d(d,{GameOfLifeModule:()=>B});var g=f(6895),x=f(4462),s=f(1571),t=f(6682);const m="#define GLSLIFY 1\nout vec2 uvInterpolator;\n\nvoid main() {\n  uvInterpolator = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",y=["canvas"],C=[{path:"",component:(()=>{class i{ngAfterViewInit(){this.createRenderer(),this.createCamera();const e=this.renderer.domElement,a=this.createRandomDataTexture(),r=new t.xsS,n=new t.xsS,o=new t._12(2,2,1,1),u=new t.Pa4(e.width,e.height,window.devicePixelRatio);this.renderBufferA=new t.dd2(e.width,e.height),this.renderBufferB=new t.dd2(e.width,e.height),this.bufferMaterial=new t.jyz({uniforms:{u_texture:{value:a},u_resolution:{value:u}},vertexShader:m,fragmentShader:"#define GLSLIFY 1\nin vec2 uvInterpolator;\n\nuniform vec2 u_resolution;\nuniform sampler2D u_texture;\n\nfloat getNeighboursCount(vec2 p) {\n  float count = 0.0;\n\n  for(float y = -1.0; y <= 1.0; y++) {\n    for(float x = -1.0; x <= 1.0; x++) {\n\n      if(x == 0.0 && y == 0.0)\n        continue;\n\n      vec2 offset = vec2(x, y) / u_resolution.xy;\n      vec4 neighbour = texture2D(u_texture, p + offset);\n      count += neighbour.g > 0.5 ? 1.0 : 0.0;\n    }\n  }\n\n  return count;\n}\n\nvoid main() {\n  vec2 uv = uvInterpolator;\n\n  vec3 color = vec3(0.0);\n\n  bool alive = texture2D(u_texture, uv).g > 0.5;\n  float neighbors = getNeighboursCount(uv);\n\n  if(alive && (neighbors == 2.0 || neighbors == 3.0)) {\n    color = vec3(1.0);\n  } else if(!alive && (neighbors == 3.0)) {\n    color = vec3(0.0, 1.0, 0.0);\n  }\n\n  gl_FragColor = vec4(color, 1.0);\n}\n"}),this.material=new t.jyz({uniforms:{u_texture:{value:null},u_resolution:{value:u}},vertexShader:m,fragmentShader:"#define GLSLIFY 1\nin vec2 uvInterpolator;\n\nuniform sampler2D u_texture;\n\nvoid main() {\n  vec2 uv = uvInterpolator;\n  vec4 color = texture2D(u_texture, uv);\n  gl_FragColor = vec4(color.rgb, 1.0);\n}\n"});const c=new t.Kj0(o,this.bufferMaterial);n.add(c);const l=new t.Kj0(o,this.material);r.add(l);const v=()=>{this.resize(this.renderer,this.camera),this.renderer.setRenderTarget(this.renderBufferA),this.renderer.render(n,this.camera),l.material.uniforms.u_texture.value=this.renderBufferA.texture,this.renderer.setRenderTarget(null),this.renderer.render(r,this.camera);const b=this.renderBufferA;this.renderBufferA=this.renderBufferB,this.renderBufferB=b,this.bufferMaterial.uniforms.u_texture.value=this.renderBufferB.texture,this.animationId=window.requestAnimationFrame(v)};this.animationId=window.requestAnimationFrame(v)}ngOnDestroy(){cancelAnimationFrame(this.animationId)}createRenderer(){this.renderer=new t.CP7({canvas:this.canvasElement.nativeElement})}createCamera(){this.camera=new t.iKG(-1,1,1,-1,0,1)}resize(e,a){const r=e.domElement,n=r.clientWidth,o=r.clientHeight;(r.width!==n||r.height!==o)&&(e.setSize(n,o,!1),a.updateProjectionMatrix(),this.renderBufferA.setSize(n,o),this.renderBufferB.setSize(n,o),this.bufferMaterial.uniforms.u_resolution.value.x=n,this.bufferMaterial.uniforms.u_resolution.value.y=o,this.material.uniforms.u_resolution.value.x=n,this.material.uniforms.u_resolution.value.y=o)}createRandomDataTexture(){const e=this.renderer.domElement.width,a=this.renderer.domElement.height,r=e*a,n=new Uint8Array(4*r);for(let u=0;u<r;u++){const c=4*u,l=Math.random()>.96?255:0;n[c]=l,n[c+1]=l,n[c+2]=l,n[c+3]=255}const o=new t.IEO(n,e,a,t.wk1);return o.needsUpdate=!0,o}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=s.Xpm({type:i,selectors:[["app-game-of-life"]],viewQuery:function(e,a){if(1&e&&s.Gf(y,5,s.SBq),2&e){let r;s.iGM(r=s.CRH())&&(a.canvasElement=r.first)}},decls:2,vars:0,consts:[[1,"canvas"],["canvas",""]],template:function(e,a){1&e&&s._UZ(0,"canvas",0,1)},styles:["[_nghost-%COMP%]{position:relative;height:100%;display:grid;place-items:center;background-color:#181818;overflow:hidden}.canvas[_ngcontent-%COMP%]{display:block;width:100%;height:100%}"]}),i})()}];let B=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=s.oAB({type:i}),i.\u0275inj=s.cJS({imports:[g.ez,x.Bz.forChild(C)]}),i})()}}]);