"use strict";(self.webpackChunkthreejs_learning=self.webpackChunkthreejs_learning||[]).push([[911],{2144:(j,u,o)=>{o.d(u,{V:()=>f});class f{static randomFloat(e,t){return e+Math.random()*(t-e)}static randomSign(){return Math.random()>.5?1:-1}static randomGaussian(e=0,t=1){const M=1-Math.random(),m=Math.random();return Math.sqrt(-2*Math.log(M))*Math.cos(2*Math.PI*m)*t+e}static randomRadian(){return Math.random()*Math.PI*2}static degreeToRadian(e){return Math.PI/180*e}}},6911:(j,u,o)=>{o.r(u),o.d(u,{EarthCoordsModule:()=>V});var f=o(6895),C=o(4462),e=o(1571),t=o(6682),M=o(7152),m=o(2144);const U=[{name:"saratov",lat:51.54,long:46.01},{name:"minsk",lat:53.54,long:27.34},{name:"vilnius",lat:54.69,long:25.28},{name:"verona",lat:45.43,long:10.59},{name:"lisbon",lat:38.71,long:-9.13},{name:"washington",lat:38.89,long:-77.04},{name:"las-vegas",lat:36.18,long:-115.14}];var F=o(727),I=o(4968);const R=["canvas"],G=[{path:"",component:(()=>{class a{constructor(n){this.elementRef=n,this.subscription=new F.w0}ngAfterViewInit(){const n=this.elementRef.nativeElement,r=this.canvasElement.nativeElement,v={earth:(new t.dpR).load("assets/textures/earth.jpg")},l=new t.cPb(70,r.clientWidth/r.clientHeight,.01,20);l.position.z=2.5;const O=new t.Kj0(new t.xo$(1,32,32),new t.jyz({vertexShader:"#define GLSLIFY 1\nout vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragmentShader:"#define GLSLIFY 1\nin vec2 vUv;\n\nuniform sampler2D uTexture;\n\nvoid main() {\n  gl_FragColor = texture2D(uTexture, vUv);\n}\n",uniforms:{uTexture:{value:v.earth}}})),p=new t.xsS;p.add(O);const P=U.map(s=>this.getPositionOnEarth(s));P.forEach(s=>{const h=new t.Kj0(new t.xo$(.01,8,8),new t.vBJ({color:"#f00"}));h.position.set(s.x,s.y,s.z),p.add(h)});const S=new t.jyz({vertexShader:"#define GLSLIFY 1\nout vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragmentShader:"#define GLSLIFY 1\nin vec2 vUv;\n\nuniform float uTime;\n\nvoid main() {\n  float dash = sin(vUv.x * 50.0 - uTime * 0.005);\n\n  if(dash < 0.0)\n    discard;\n\n  gl_FragColor = vec4(vUv.x, 1.0, 1.0, 1.0);\n}\n",transparent:!0,side:t.ehD,uniforms:{uTime:{value:0}}});P.reduce((s,h)=>{let z=[];for(let g=0;g<=20;g++){const x=(new t.Pa4).lerpVectors(s,h,g/20);x.normalize(),x.multiplyScalar(1+.05*Math.sin(Math.PI*g/20)),z.push(x)}const B=new t.YT8(z),W=new t.Kj0(new t.WXh(B,20,.002,8,!1),S);return p.add(W),h});const d=new t.CP7({canvas:r,antialias:!0});d.setSize(n.clientWidth,n.clientHeight),d.setAnimationLoop(function Y(s){S.uniforms.uTime.value=s+=.01,d.render(p,l)}),this.renderer=d;const y=new M.z(l,this.renderer.domElement);y.target.set(0,0,0),y.update(),this.subscription.add((0,I.R)(window,"resize").subscribe(()=>{l.aspect=n.clientWidth/n.clientHeight,l.updateProjectionMatrix(),d.setSize(n.clientWidth,n.clientHeight)}))}ngOnDestroy(){this.subscription.unsubscribe(),this.renderer.setAnimationLoop(null)}getPositionOnEarth({lat:n,long:r}){const i=m.V.degreeToRadian(90-n),v=m.V.degreeToRadian(180+r);return new t.Pa4(-Math.sin(i)*Math.cos(v),Math.cos(i),Math.sin(i)*Math.sin(v))}}return a.\u0275fac=function(n){return new(n||a)(e.Y36(e.SBq))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-earth-coords"]],viewQuery:function(n,r){if(1&n&&e.Gf(R,5,e.SBq),2&n){let i;e.iGM(i=e.CRH())&&(r.canvasElement=i.first)}},decls:2,vars:0,consts:[[1,"canvas"],["canvas",""]],template:function(n,r){1&n&&e._UZ(0,"canvas",0,1)},styles:["[_nghost-%COMP%]{position:relative;display:block;height:100%;overflow:hidden}.canvas[_ngcontent-%COMP%]{display:block;width:100%;height:100%}"]}),a})()}];let V=(()=>{class a{}return a.\u0275fac=function(n){return new(n||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[f.ez,C.Bz.forChild(G)]}),a})()}}]);